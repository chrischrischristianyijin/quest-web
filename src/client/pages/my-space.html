<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的空间 - Quest</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/my-space.css">
</head>

<body>
    <div class="MySpace">
        <!-- Header Section -->
        <div class="header-section">
            <div class="left">
                <a href="/" class="Quest">
                    <img src="/public/logo.png" alt="Quest">
                </a>
            </div>
            <div class="WelcomeToYourPersonalSpacePlaceholder">Welcome, Placeholder!</div>
            <div class="right">
                <div class="header-user-menu" id="headerUserMenu">
                    <div class="header-avatar-container" id="headerAvatarContainer">
                        <img src="/public/3d_avatar_12.png" alt="User Avatar" class="header-avatar" id="headerAvatar">
                    </div>
                    <div class="header-dropdown" id="headerDropdown">
                        <button class="header-dropdown-item" id="headerEditProfile">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            Edit Profile
                        </button>
                        <button class="header-dropdown-item" id="headerLogout">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17L21 12L16 7M21 12H9"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            Log Out
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-area">
                <!-- Profile Section -->
                <div class="profile-section">
                    <div class="profile-container clickable-profile" id="profileContainer">
                        <div class="profile-avatar" id="profileAvatar">
                            <!-- Avatar skeleton loading state -->
                            <div class="avatar-skeleton" id="avatarSkeleton"></div>
                            <!-- Actual avatar (initially hidden) -->
                            <img src="/public/3d_avatar_12.png" alt="User Avatar" id="userAvatar"
                                style="display: none;">
                            <div class="edit-overlay">
                                <svg class="edit-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                            </div>
                        </div>
                        <div class="UsernamePlaceholder" id="usernamePlaceholder">
                            <!-- Username skeleton -->
                            <div class="username-skeleton" id="usernameSkeleton"></div>
                            <!-- Actual username (initially hidden) -->
                            <span id="actualUsername" style="display: none;">Username</span>
                            <span class="edit-hint">Click to edit</span>
                        </div>
                    </div>
                </div>

                <!-- Controls Section -->
                <div class="controls-section">
                    <div class="left">
                        <div class="FilterButtons" id="filterButtons">
                            <!-- Loading state for filter buttons -->
                            <div class="filter-loading" id="filterLoading">
                                <div class="filter-skeleton-btn"></div>
                                <div class="filter-skeleton-btn"></div>
                                <div class="filter-skeleton-btn"></div>
                            </div>
                            <!-- Filter buttons will be dynamically generated by JavaScript -->
                        </div>
                        <button class="add-content-btn-left" id="addContentBtnLeft">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            Add Content
                        </button>
                    </div>
                    <div class="right">
                        <button class="edit-mode-btn" id="editModeBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            <span class="edit-btn-text">Edit</span>
                        </button>
                    </div>
                </div>

                <!-- Content Cards -->
                <div class="ContentCards" id="contentCards">
                    <!-- Loading skeleton -->
                    <div class="loading-skeleton" id="loadingSkeleton">
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                    </div>
                    <!-- Content cards will be dynamically generated by JavaScript -->
                </div>

                <!-- Pagination Controls -->
                <div class="pagination-container" id="paginationContainer">
                    <div class="pagination-info">
                        <span class="pagination-text">第 <span id="currentPage">1</span> 页，共 <span id="totalPages">1</span> 页</span>
                        <span class="pagination-count">共 <span id="totalInsights">0</span> 个见解</span>
                    </div>
                    <div class="pagination-controls">
                        <button class="pagination-btn pagination-btn-prev" id="prevPageBtn" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            上一页
                        </button>
                        <div class="pagination-pages" id="paginationPages">
                            <!-- Page numbers will be dynamically generated -->
                        </div>
                        <button class="pagination-btn pagination-btn-next" id="nextPageBtn" disabled>
                            下一页
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Content Modal -->
    <div class="add-content-modal" id="addContentModal">
        <div class="add-content-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Content</h2>
                <button class="modal-close" id="closeAddModal">&times;</button>
            </div>
            <form id="addContentForm">
                <div class="form-group">
                    <label class="form-label" for="contentUrl">Content URL</label>
                    <input type="url" id="contentUrl" class="form-input" required placeholder="https://...">
                </div>

                <div class="form-group">
                    <label class="form-label" for="customTitle">Custom Title (Optional)</label>
                    <input type="text" id="customTitle" class="form-input"
                        placeholder="Enter custom title or leave empty to use webpage title">
                </div>

                <div class="form-group">
                    <label class="form-label" for="customThought">Your Thoughts (Optional)</label>
                    <textarea id="customThought" class="form-textarea" rows="3"
                        placeholder="Share your thoughts, insights, or notes about this content"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" for="tagSelector">Tag (Optional)</label>
                    <div class="tag-selector-container">
                        <div class="tag-selector-header">
                            <div class="tag-selector-dropdown" id="tagSelectorDropdown">
                                <div class="tag-selector-trigger" id="tagSelectorTrigger">
                                    <span class="tag-selector-text">Select a tag...</span>
                                    <svg class="tag-selector-arrow" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none">
                                        <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div class="tag-selector-options" id="tagSelectorOptions">
                                    <!-- Tag options will be dynamically generated -->
                                </div>
                            </div>
                            <button type="button" class="tag-action-btn edit-tags-btn" id="manageTagsBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                                Edit Tags
                            </button>
                        </div>
                        <div class="selected-tags-display" id="selectedTagsDisplay">
                            <!-- Selected tag will be shown here -->
                        </div>
                    </div>
                    <div class="tag-actions">
                        <button type="button" class="tag-action-btn" id="createTagBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M12 5V19M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            Create New Tag
                        </button>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelAddBtn">Cancel</button>
                    <button type="submit" class="modal-btn modal-btn-primary" id="addContentBtn">
                        <span id="addContentBtnText">Add Content</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Tag Modal -->
    <div class="create-tag-modal" id="createTagModal">
        <div class="create-tag-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create New Tag</h2>
                <button class="modal-close" id="closeCreateTagModal">&times;</button>
            </div>
            <form id="createTagForm">
                <div class="form-group">
                    <label class="form-label" for="newTagName">Tag Name</label>
                    <input type="text" id="newTagName" class="form-input" required placeholder="Enter tag name">
                </div>
                <div class="form-group">
                    <label class="form-label" for="newTagColor">Tag Color</label>
                    <div class="color-picker">
                        <input type="color" id="newTagColor" class="color-input" value="#FF5733">
                        <div class="color-presets">
                            <button type="button" class="color-preset" data-color="#FF5733"
                                style="background-color: #FF5733;"></button>
                            <button type="button" class="color-preset" data-color="#33FF57"
                                style="background-color: #33FF57;"></button>
                            <button type="button" class="color-preset" data-color="#3357FF"
                                style="background-color: #3357FF;"></button>
                            <button type="button" class="color-preset" data-color="#F3FF33"
                                style="background-color: #F3FF33;"></button>
                            <button type="button" class="color-preset" data-color="#FF33F3"
                                style="background-color: #FF33F3;"></button>
                            <button type="button" class="color-preset" data-color="#33FFF3"
                                style="background-color: #33FFF3;"></button>
                            <button type="button" class="color-preset" data-color="#FF8333"
                                style="background-color: #FF8333;"></button>
                            <button type="button" class="color-preset" data-color="#8333FF"
                                style="background-color: #8333FF;"></button>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelCreateTagBtn">Cancel</button>
                    <button type="submit" class="modal-btn modal-btn-primary" id="submitCreateTagBtn">Create
                        Tag</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Manage Tags Modal -->
    <div class="manage-tags-modal" id="manageTagsModal">
        <div class="manage-tags-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Manage Tags</h2>
                <button class="modal-close" id="closeManageTagsModal">&times;</button>
            </div>
            <div class="tags-management">
                <div class="tags-list" id="manageTagsList">
                    <!-- Tags will be dynamically generated -->
                </div>
                <div class="tags-stats" id="tagsStats">
                    <!-- Tags statistics will be shown here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="closeManageTagsBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="profile-edit-modal" id="profileEditModal">
        <div class="profile-edit-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Profile</h2>
                <button class="modal-close" id="closeProfileModal">&times;</button>
            </div>
            <form id="profileEditForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="profileUsername">Username</label>
                        <input type="text" id="profileUsername" class="form-input" required
                            placeholder="Enter your username">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="profileEmail">Email</label>
                        <input type="email" id="profileEmail" class="form-input" required
                            placeholder="Enter your email">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="profilePassword">Password</label>
                        <input type="password" id="profilePassword" class="form-input"
                            placeholder="Enter new password (optional)">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="profileConfirmPassword">Confirm Password</label>
                        <input type="password" id="profileConfirmPassword" class="form-input"
                            placeholder="Confirm new password">
                    </div>
                </div>

                <div class="avatar-section">
                    <label class="form-label">Avatar</label>
                    <div class="avatar-upload-container">
                        <div class="avatar-preview-large" id="avatarPreviewLarge">
                            <img id="avatarPreviewImg" src="/public/3d_avatar_12.png" alt="Avatar Preview">
                            <div class="avatar-edit-overlay">
                                <button type="button" class="avatar-edit-btn" id="avatarEditBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                        <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                    Edit
                                </button>
                            </div>
                        </div>
                        <input type="file" id="profileAvatarUpload" class="form-input-hidden" accept="image/*">
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancelProfileEdit">Cancel</button>
                    <button type="submit" class="modal-btn modal-btn-primary" id="saveProfileEdit">
                        <span id="saveProfileBtnText">Save</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Content Detail Modal -->
    <div class="content-detail-modal" id="contentDetailModal">
        <div class="content-detail-overlay" id="contentDetailOverlay"></div>
        <div class="content-detail-container">
            <!-- Modal Header with Close Button -->
            <div class="modal-header">
                <button class="modal-close-btn" id="contentDetailClose">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </button>
            </div>

            <!-- Main Content -->
            <div class="modal-content">
                <!-- Top Header Row -->
                <div class="modal-top-header">
                    <div class="content-header">
                        <h1 class="content-title" id="modalContentTitle">The Placeholder Title</h1>
                        <div class="content-tags">
                            <span class="project-tag">Project</span>
                            <button class="edit-tags-btn" id="modalEditTagsBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                                Edit Tags
                            </button>
                        </div>
                    </div>

                    <button class="share-my-space-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8M16 6l-4-4-4 4M12 2v13"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Share
                    </button>
                </div>

                <!-- Main Content Layout -->
                <div class="main-content-layout">
                    <!-- Image Placeholder -->
                    <div class="image-placeholder" id="modalImagePlaceholder">
                        <!-- Image will be inserted here or show placeholder -->
                    </div>

                    <!-- Content Sections -->
                    <div class="content-sections">
                        <!-- My Comment Section -->
                        <div class="comment-section">
                            <h3 class="section-title">My Comment</h3>
                            <div class="comment-content" id="modalCommentContent">
                                <div class="comment-text" id="modalCommentText">
                                    No comment added yet.
                                </div>
                                <button class="edit-comment-btn" id="editCommentBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                        <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                    Edit
                                </button>
                            </div>
                            <div class="comment-edit-form" id="commentEditForm" style="display: none;">
                                <textarea class="comment-edit-textarea" id="commentEditTextarea" rows="4"
                                    placeholder="Enter your comment..."></textarea>
                                <div class="comment-edit-actions">
                                    <button class="save-comment-btn" id="saveCommentBtn">Save</button>
                                    <button class="cancel-comment-btn" id="cancelCommentBtn">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <!-- AI Summary Section -->
                        <div class="ai-summary-section">
                            <div class="ai-summary-header">
                                <h3 class="section-title">AI Summary</h3>
                                <div class="ai-summary-date">MMDD, 2025</div>
                            </div>
                            <div class="ai-summary-content">
                                <div class="ai-summary-text">
                                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas facilisis tempor
                                    elementum. Mauris eu bibendum est, nec iaculis nunc. Lorem ipsum dolor sit amet,
                                    consectetur adipiscing elit. Maecenas facilisis tempor elementum. Mauris eu bibendum
                                    est, nec iaculis nunc.
                                </div>
                            </div>
                        </div>

                        <!-- Quest Suggestions Section -->
                        <div class="quest-suggestions-section">
                            <h3 class="section-title">Quest Suggestions</h3>
                            <div class="quest-suggestions-grid" id="questSuggestionsGrid">
                                <!-- Quest suggestion cards will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Performance optimization scripts -->
    <script src="/js/logger.js"></script>
    <script src="/js/cache.js"></script>
    <script type="module" src="/js/my-space.js"></script>
</body>

</html>